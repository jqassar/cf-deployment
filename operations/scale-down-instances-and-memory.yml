# This opsfile lowers the instance count to 1 (as in bosh-lite) and
# lowers default memory, but does not combine services or reduce the AZs
# (as in scale-to-one-az).
# ----- Scale Down ------
- type: replace
  path: /instance_groups/name=consul?
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=nats
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=diego-api
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=uaa
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=scheduler
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=diego-cell
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=diego-cell/jobs/name=rep/properties/diego/rep/evacuation_timeout_in_seconds?
  value: 0
- type: replace
  path: /instance_groups/name=router
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=tcp-router
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=api
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=cc-worker
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=adapter
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=doppler
  value:
    instances: 1
    vm_type: minimal
- type: replace
  path: /instance_groups/name=log-api
  value:
    instances: 1
    vm_type: minimal

# ----- Reduce default app memory to 256M ------
- type: replace
  path: /instance_groups/name=api/jobs/name=cloud_controller_ng/properties/cc/default_app_memory?
  value: 256
